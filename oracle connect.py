import cx_Oracle
Limit = 10
def generator(limit):
    connection = cx_Oracle.connect('pentagonsurv/pentagonsurv@10.97.144.145:1521/orcl')
    cur = connection.cursor()
    #cur.arraysize = 100000 
    query = "SELECT * FROM ATSD_INS_INSTRUMENT"
    cur.execute("DELETE  FROM ATSD_INS_INSTRUMENT")
    cur.execute("SELECT * FROM ATSD_INS_INSTRUMENT")
    columns = [row[0] for row in cur.description][0:-2] 
    defaultColumns = ['DEFINITION_ID', 'INSTRUMENT_ID', 'MODIFIED_BY', 'MODIFIED_DATE', 'MODIFIED_REASON', 'MODIFIED_TIME', 'SYMBOL', 'CONTRACT_MULTIPLIER', 'CURRENCY_CODE', 'EXPIRY_DATE', 'INSTRUMENT_RANK', 'INSTRUMENT_STATUS', 'INSTRUMENT_SUB_TYPE', 'INTERNAL_INSTRUMENT_TYPE', 'ISIN', 'ISSUED_QTY', 'MARKET_ID', 'MSG_POSITION', 'ORIGIN', 'PARTITION_ID', 'PREV_CLOSE_PRICE', 'PRODUCT_CLASS', 'PRODUCT_TYPE', 'ROUTING_SEQ', 'SECTOR_ID', 'SECURITY_DESCRIPTION', 'SEGMENT_ID', 'STAT_COUNT_DOWN', 'STATUS_FLAG', 'STRIKE_PRICE', 'SYMBOL_CHANGE_MODE', 'SYSTEM_TIME', 'THREAD_ID', 'TIME_SEQUENCE', 'TRANSACT_TIME', 'TRANSACTION_ID', 'UNDERLYER_INSTRUMENT_ID', 'UNIQUE_ID', 'UNIQUE_INDEX', 'VALIDITY', 'VIEW_INDICATOR', 'INSTANCE_INDEX', 'IS_ACTIVE', 'EXCHANGE_TRANSACTION_ID', 'LIQUIDITY_BRACKET_ID', 'TIF', 'TRADING_CYCLE', 'CLEARING_TYPE', 'TOTAL_NEW_ORDER_VOLUME', 'TOTAL_SMALL_ORDERS', 'CLOSING_MID_VALUE', 'TOTAL_NEW_ORDER_VALUE', 'TOTAL_ORDERS', 'TOTAL_LIMIT_ORDERS', 'INSTRUMENT_QUOTE_TYPE', 'AUCTION_TIME', 'AUCTION_START_TIME', 'TRADING_STATUS', 'LSE_CURRENCY_CODE', 'DEFAULT_CONVERSION_RATE', 'PRIMARY_BOOK', 'OAC_ORDER_SIZE', 'OAC_ORDERS', 'CAC_ORDER_SIZE', 'CAC_ORDERS', 'TOPVSPC_PERCENTAGE', 'MINIMUM_RESERVE_VALUE', 'TOTAL_BUY_TRADES', 'TOTAL_NEW_ORDERS', 'DEFAULT_ORDER_BOOK', 'TOTAL_SMALL_TRADES', 'EXECUTION_MIN_SIZE', 'TRADING_PARAMETER_ID', 'INDEX_POSITION', 'NB_SESSION', 'OB_SESSION', 'QB_SESSION', 'LIQUIDITY', 'ADT', 'REFERENCE_PRICE', 'INTRADAY', 'SYSTEM', 'DYNAMIC_UPDATE_SNAPSHOT_ID', 'NOTIONAL_CURRENCY', 'PRICE_NOTATION', 'ALTERNATE_SECURITY_TYPE', 'DENOMINATED_PAR_VALUE', 'EXECUTION_VENUE', 'MIFIR_IDENTIFIER', 'MIFIR_SUBCLASS_IDENTIFIER', 'PRIMARY_VENUE', 'TRADING_VENUE', 'SURV_REFDATA_EXIST', 'REFFED_TOKEN', 'FLAG_FOR_DELETE', 'ORDER_DELETION_TIME', 'TIME_DIFFERENCE', 'REFPRICE', 'LAST_TRADING_DATE', 'OPTION_TYPE', 'PRICING_MODEL', 'REFERENCE_PRICE_TABLE', 'SETTLEMENT_METHOD', 'FIRST_TRADING_DATE', 'INSTRUMENT_CATEGORY', 'ISSUED_DATE', 'DELETION_DATE', 'PAR_VALUE', 'SECURITY_TYPE', 'BLUE_MONTH', 'MATURITY_DATE', 'PARENT_INSTRUMENT_ID', 'NEAR_MONTH_MATURITY', 'FAR_MONTH_MATURITY', 'NEAR_MONTH_TYPE', 'FAR_MONTH_TYPE', 'UNDERLYER_SYMBOL', 'STRATEGIES', 'VENUE', 'LEG1_UNIQUEID', 'LEG2_UNIQUEID', 'ISSUER_ID', 'LOAD_ID', 'EXERCISE_STYLE', 'ORDER_DELETION_DATE', 'BASE_CURRENCY', 'FAR_LEG_TENOR_MULTIPLIER', 'FAR_LEG_TENOR_PERIOD_TYPE', 'NEAR_LEG_TENOR_MULTIPLIER', 'NEAR_LEG_TENOR_PERIOD_TYPE', 'QUOTE_CURRENCY', 'SPOT_DATE_OFFSET', 'TENOR_PERIOD_MULTIPLIER', 'TENOR_PERIOD_TYPE', 'TRADING_ROOM', 'TRADING_LOCATION', 'TRADING_ROOM_ID', 'SPOT_INSTRUMENT', 'STANDARD_SPOT', 'NEAR_LEG_TENOR_SYMBOL', 'FAR_LEG_TENOR_SYMBOL', 'NEAR_LEG_SETTLEMENT_DATE', 'FAR_LEG_SETTLEMENT_DATE', 'EXCHANGE_SYMBOL']
    sql_dict = {'DEFINITION_ID': "'INSTRUMENT'", 'INSTRUMENT_ID': "'EUR/GBP_93_Primary CLOB_LD'", 'MODIFIED_BY': "'Lilan'", 'MODIFIED_DATE': "'2022/06/23'", 'MODIFIED_REASON': "'Request generated by Reference Data Upload'", 'MODIFIED_TIME': "'10:52:29'", 'SYMBOL': "'EUR/GBP_93'", 'CONTRACT_MULTIPLIER': 1, 'CURRENCY_CODE': 0, 'EXPIRY_DATE': 'NULL', 'INSTRUMENT_RANK': 0, 'INSTRUMENT_STATUS': 1, 'INSTRUMENT_SUB_TYPE': 0, 'INTERNAL_INSTRUMENT_TYPE': 25, 'ISIN': 'NULL', 'ISSUED_QTY': 0, 'MARKET_ID': "'NJ_FX_MARKET'", 'MSG_POSITION': 0, 'ORIGIN': 0, 'PARTITION_ID': 1, 'PREV_CLOSE_PRICE': -9999999, 'PRODUCT_CLASS': 'NULL', 'PRODUCT_TYPE': 551, 'ROUTING_SEQ': 204, 'SECTOR_ID': "'TMP'", 'SECURITY_DESCRIPTION': "'MDS MCAST Channel=3'", 'SEGMENT_ID': "'Default'", 'STAT_COUNT_DOWN': 1, 'STATUS_FLAG': 0, 'STRIKE_PRICE': 0, 'SYMBOL_CHANGE_MODE': 0, 'SYSTEM_TIME': 0, 'THREAD_ID': 0, 'TIME_SEQUENCE': 1675296001001999000, 'TRANSACT_TIME': "'20230202-00:00:01.001999'", 'TRANSACTION_ID': 1, 'UNDERLYER_INSTRUMENT_ID': "' '", 'UNIQUE_ID': "'exch0001'", 'UNIQUE_INDEX': 0, 'VALIDITY': 0, 'VIEW_INDICATOR': 0, 'INSTANCE_INDEX': 193, 'IS_ACTIVE': 2, 'EXCHANGE_TRANSACTION_ID': 1, 'LIQUIDITY_BRACKET_ID': "'LB_1'", 'TIF': 0, 'TRADING_CYCLE': 'NULL', 'CLEARING_TYPE': 0, 'TOTAL_NEW_ORDER_VOLUME': 0, 'TOTAL_SMALL_ORDERS': 0, 'CLOSING_MID_VALUE': 0, 'TOTAL_NEW_ORDER_VALUE': 0, 'TOTAL_ORDERS': 0, 'TOTAL_LIMIT_ORDERS': 0, 'INSTRUMENT_QUOTE_TYPE': 0, 'AUCTION_TIME': 0, 'AUCTION_START_TIME': 0, 'TRADING_STATUS': 0, 'LSE_CURRENCY_CODE': 'NULL', 'DEFAULT_CONVERSION_RATE': 0, 'PRIMARY_BOOK': 0, 'OAC_ORDER_SIZE': 0, 'OAC_ORDERS': 0, 'CAC_ORDER_SIZE': 0, 'CAC_ORDERS': 0, 'TOPVSPC_PERCENTAGE': 0, 'MINIMUM_RESERVE_VALUE': 0, 'TOTAL_BUY_TRADES': 0, 'TOTAL_NEW_ORDERS': 0, 'DEFAULT_ORDER_BOOK': 0, 'TOTAL_SMALL_TRADES': 0, 'EXECUTION_MIN_SIZE': 0, 'TRADING_PARAMETER_ID': "'DUMMY_TP'", 'INDEX_POSITION': 0, 'NB_SESSION': 'NULL', 'OB_SESSION': "'0'", 'QB_SESSION': "'Default'", 'LIQUIDITY': 0, 'ADT': 0, 'REFERENCE_PRICE': 0, 'INTRADAY': 0, 'SYSTEM': 0, 'DYNAMIC_UPDATE_SNAPSHOT_ID': 0, 'NOTIONAL_CURRENCY': 'NULL', 'PRICE_NOTATION': 0, 'ALTERNATE_SECURITY_TYPE': 0, 'DENOMINATED_PAR_VALUE': 0, 'EXECUTION_VENUE': 'NULL', 'MIFIR_IDENTIFIER': 'NULL', 'MIFIR_SUBCLASS_IDENTIFIER': 'NULL', 'PRIMARY_VENUE': 'NULL', 'TRADING_VENUE': 0, 'SURV_REFDATA_EXIST': 0, 'REFFED_TOKEN': 'NULL', 'FLAG_FOR_DELETE': 0, 'ORDER_DELETION_TIME': 'NULL', 'TIME_DIFFERENCE': 0, 'REFPRICE': 0, 'LAST_TRADING_DATE': 'NULL', 'OPTION_TYPE': 0, 'PRICING_MODEL': 0, 'REFERENCE_PRICE_TABLE': 'NULL', 'SETTLEMENT_METHOD': 0, 'FIRST_TRADING_DATE': 'NULL', 'INSTRUMENT_CATEGORY': 0, 'ISSUED_DATE': 'NULL', 'DELETION_DATE': 'NULL', 'PAR_VALUE': 0, 'SECURITY_TYPE': 0, 'BLUE_MONTH': 0, 'MATURITY_DATE': 'NULL', 'PARENT_INSTRUMENT_ID': 'NULL', 'NEAR_MONTH_MATURITY': 'NULL', 'FAR_MONTH_MATURITY': 'NULL', 'NEAR_MONTH_TYPE': 0, 'FAR_MONTH_TYPE': 0, 'UNDERLYER_SYMBOL': 'NULL', 'STRATEGIES': "' '", 'VENUE': "'DEF'", 'LEG1_UNIQUEID': 'NULL', 'LEG2_UNIQUEID': 'NULL', 'ISSUER_ID': "'ISS'", 'LOAD_ID': 1, 'EXERCISE_STYLE': 0, 'ORDER_DELETION_DATE': 'NULL', 'BASE_CURRENCY': "'EUR'", 'FAR_LEG_TENOR_MULTIPLIER': 0, 'FAR_LEG_TENOR_PERIOD_TYPE': 0, 'NEAR_LEG_TENOR_MULTIPLIER': 0, 'NEAR_LEG_TENOR_PERIOD_TYPE': 0, 'QUOTE_CURRENCY': "'GBP'", 'SPOT_DATE_OFFSET': 93, 'TENOR_PERIOD_MULTIPLIER': 0, 'TENOR_PERIOD_TYPE': 0, 'TRADING_ROOM': 'NULL', 'TRADING_LOCATION': "'LD'", 'TRADING_ROOM_ID': "'Primary CLOB'", 'SPOT_INSTRUMENT': "'EUR/GBP'", 'STANDARD_SPOT': 0, 'NEAR_LEG_TENOR_SYMBOL': 2, 'FAR_LEG_TENOR_SYMBOL': 0, 'NEAR_LEG_SETTLEMENT_DATE': 'NULL', 'FAR_LEG_SETTLEMENT_DATE': 'NULL', 'EXCHANGE_SYMBOL': "'SuspendedMDS3'"}
    for i in range(1,limit+1):
        colString = "Insert into ATSD_INS_INSTRUMENT ("
        valString = " Values ("
        for column in columns:
            colString += column +','
            if column in defaultColumns:          
                valString += str(sql_dict[column])+','
            else:
                valString += "New"+','
            sql_dict['UNIQUE_ID'] = "\'"+'exch'+str(i)+"\'"
            sql_dict['INSTRUMENT_ID'] = "\'"+'EUR/GBP_' + str(i) + '_Primary CLOB_LD' +"\'"   
            sql_dict['SYMBOL'] = "\'"+'EUR/GBP_' + str(i)+"\'"
            sql_dict['THREAD_ID'] = str(i%3)
            #sql_dict['SPOT_DATE_OFFSET'] = str(i)
        sqlString = colString.strip(',') + ')' + valString.strip(',') + ')'
        cur.execute(sqlString)
        print(sqlString+";")
    connection.commit()
    cur.close()
    connection.close()
generator(Limit)
